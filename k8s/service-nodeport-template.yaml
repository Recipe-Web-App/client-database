# NodePort Service for external MySQL access
# Uses envsubst for variable substitution from .env file
# Usage: envsubst < service-nodeport-template.yaml | kubectl apply -f -
#
# IMPORTANT: This is a SEPARATE service from the headless ClusterIP service.
# The headless service (service.yaml) must remain for StatefulSet DNS patterns.
# This NodePort service provides external access to the same pods.

apiVersion: v1
kind: Service
metadata:
  name: client-database-external
  namespace: client-database
  labels:
    app: client-database
    component: mysql
spec:
  type: NodePort
  ports:
    - port: 3306
      targetPort: 3306
      nodePort: ${MYSQL_NODEPORT}
      protocol: TCP
      name: mysql
  selector:
    app: client-database
    component: mysql
